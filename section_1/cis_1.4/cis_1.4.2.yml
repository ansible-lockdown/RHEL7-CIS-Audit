{{ if .Vars.rhel7cis_level_1 }}
  {{ if .Vars.rhel7cis_rule_1_4_2 }}
kernel-param:
  ptrace_scope:
    title: 1.4.2 | Ensure ptrace_scope is restricted | sysctl_live
    name: kernel.yama.ptrace_scope
    value: '1'
    meta:
      server: 1
      workstation: NA
      CIS_ID:
      - 1.4.2
      CISv8:
      - 10.5
      CISv8_IG1: true
      CISv8_IG2: true
      CISv8_IG3: true
      NIST800-53R5:
      - CM-6
      - CM-6b
command:
  ptrace_scope_conf:
    title: 1.4.2 | Ensure ptrace_scope is restricted | sysctl_configured
    exit-status:
      or:
      - 0
      - 1
    exec: 'grep -h "kernel\.yama\.ptrace_scope" /etc/sysctl.conf /etc/sysctl.d/*'
    stdout:
    - '/^kernel.yama.ptrace_scope\s*=\s*1/'
    meta:
      server: 1
      workstation: NA
      CIS_ID:
      - 1.4.2
      CISv8:
      - 10.5
      CISv8_IG1: true
      CISv8_IG2: true
      CISv8_IG3: true
      NIST800-53R5:
      - CM-6
      - CM-6b
  {{ end }}
{{ end }}
