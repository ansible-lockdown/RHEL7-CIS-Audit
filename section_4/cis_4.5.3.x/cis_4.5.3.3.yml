---

{{ if .Vars.rhel7cis_level_1 }}
  {{ if .Vars.rhel7cis_rule_4_5_3_3 }}
file:
  etc_profile_umask:
    title: 4.5.3.3 | Ensure default user umask is configured
    file: /etc/profile
    exists: true
    contents:
    - '/^(?i)\s+umask\s0(2|7)(2|7)/'
    - '!/^(?i)\s+umask\s[1-7][0-7][0-7]/'
    meta:
      server: 1
      workstation: NA
      CIS_ID:
      - 4.5.3.3
      CISv8:
      - 3.3
      CISv8_IG1: true
      CISv8_IG2: true
      CISv8_IG3: true
      NIST800-53R5:
      - AC-3
      - MP-2
  etc_login_defs_umask:
    title: 4.5.3.3 | Ensure default user umask is configured
    file: /etc/login.defs
    exists: true
    contents:
    - '/^(?i)\s+umask\s0(2|7)(2|7)/'
    - '!/^(?i)\s+umask\s[1-7][0-7][0-7]/'
    meta:
      server: 1
      workstation: NA
      CIS_ID:
      - 4.5.3.3
      CISv8:
      - 3.3
      CISv8_IG1: true
      CISv8_IG2: true
      CISv8_IG3: true
      NIST800-53R5:
      - AC-3
      - MP-2
  etc_bashrc_umask:
    title: 4.5.3.3 | Ensure default user umask is configured
    file: /etc/bashrc
    exists: true
    contents:
    - '/^(?i)\s+umask\s0(2|7)(2|7)/'
    - '!/^(?i)\s+umask\s[1-7][0-7][0-7]/'
    meta:
      server: 1
      workstation: NA
      CIS_ID:
      - 4.5.3.3
      CISv8:
      - 3.3
      CISv8_IG1: true
      CISv8_IG2: true
      CISv8_IG3: true
      NIST800-53R5:
      - AC-3
      - MP-2
  {{ end }}
{{ end }}
